---
import InfoModal from "./InfoModal.astro";
---

<div class="flex text-center">
  <script>
    function setup() {
      const player = document.getElementById("player");
      if (!player) return;
      const playerImg = player.querySelector("img");
      if (!playerImg) return;
      const playerWidth = playerImg.width;
      const playerHeight = playerImg.height;
      let playerX = player.offsetLeft;
      let playerY = player.offsetTop;
      const playerSpeed = 5;

      let nextX = playerX;
      let nextY = playerY;
      function movePlayer() {
        const boundsElement = document.getElementById("bounds");
        if (!boundsElement) return;
        const bounds = boundsElement.getBoundingClientRect();
        if (nextX < bounds.left) nextX = bounds.left;
        if (nextX + playerWidth > bounds.right) nextX = bounds.right - playerWidth;
        if (nextY < bounds.top) nextY = bounds.top;
        if (nextY + playerHeight > bounds.bottom) nextY = bounds.bottom - playerHeight;

        const dx = nextX - playerX;
        const dy = nextY - playerY;
        const distance = Math.sqrt(dx * dx + dy * dy);
        if (distance < playerSpeed) {
          playerX = nextX;
          playerY = nextY;
        } else {
          playerX += (dx / distance) * playerSpeed;
          playerY += (dy / distance) * playerSpeed;
        }
        player!.style.left = `${playerX}px`;
        player!.style.top = `${playerY}px`;
      }

      document.addEventListener("mousedown", (e) => {
        console.log("move");
        nextX = e.clientX - playerWidth / 2;
        nextY = e.clientY - playerHeight / 2;
        console.log(player.style.left, player.style.top);
      });
      setInterval(movePlayer, 1000 / 60);
    }
    window.addEventListener("load", setup);
  </script>
  <InfoModal />
  <div id="bounds" class="w-[300px] h-[300px] bg-red-500 absolute left-64 top-48"></div>
  <div id="player" class="absolute left-64 top-48 z-40">
    <img src="/assets/devon.png" alt="Devon Crebbin" class="w-auto h-[10rem]" />
    <!-- <div class="w-[3rem] h-[1.5rem] bg-black/30 rounded-full blur-sm absolute left-[18.8rem] top-[20.9rem] z-30"></div> -->
  </div>
</div>
